listen 80;

root /app/public;
index index.php index.html index.htm;

disable_symlinks off;

location / {
  try_files $uri $uri/ /index.php?$args;
}

location = /favicon.ico {
  log_not_found off;
  access_log off;
}

location = /robots.txt {
  allow all;
  log_not_found off;
  access_log off;
}

location ^~ /system/logs/ {
  deny all;
}

location ^~ /templates/ {
  deny all;
}

location ^~ /system/bin/ {
  deny all;
}

location ^~ /system/config/ {
  deny all;
}

location ~* \.(tpl|html5|xhtml)$ {
  deny all;
}

location ~ /\. {
  deny all;
}

location ~ \.php(?:$|/) {
  try_files $uri =404;

  fastcgi_pass 127.0.0.1:9000;
  fastcgi_index index.php;
  fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
  include /etc/nginx/fastcgi.conf;
  fastcgi_intercept_errors on;
}
